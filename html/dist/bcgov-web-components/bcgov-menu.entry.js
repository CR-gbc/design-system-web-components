import{r as e,h as i,H as t,g as s}from"./p-100c0da1.js";import{m as n,a,k as o}from"./p-129bfbdc.js";const l=class{constructor(i){e(this,i),this.alignment="left",this.menuId="menu",this.instructions="Use arrow keys to navigate between menuitems,\n  spacebar to expand submenus, escape key to close submenus, enter to activate menuitems.",this.breakpoint=0,this.hamburger=!0,this.active=!1,this.allowHover=!1,this.menuTimeOut=500,this.isSubmenu=!1,this.showSubmenu=(e,i)=>{if(!this.isSubmenu)return;i?e.classList.add("expanded"):e.classList.remove("expanded"),e.setAttribute("aria-expanded",i?"true":"false"),e.setAttribute("tabindex",i?"-1":"0"),e.setAttribute("aria-selected",i?"true":"false");const t=e.querySelector("ul");if(null!==t)if(t.setAttribute("aria-hidden",i?"false":"true"),i){const i=e.querySelector("ul > li:first-child");i.setAttribute("tabindex","-1"),i.focus()}else this.el.focus()}}componentWillLoad(){this.isSubmenu="UL"===this.el.parentElement.nodeName,[].forEach.call(this.el.querySelectorAll("a"),function(e){n(e)});const e=this;this.bodyTag=document.getElementsByTagName("BODY")[0],this.isSubmenu||(this.isDesktop(),window.addEventListener("resize",function(){e.isDesktop()}))}componentDidRender(){if(this.isSubmenu){this.el.setAttribute("aria-haspopup",!0),this.el.setAttribute("aria-expanded",!1),this.el.setAttribute("aria-selected",!1),this.el.setAttribute("tabindex",-1);const e=this.el.closest("bcgov-menu[primary]");null!==e&&(this.allowHover=this.allowHover||e.hasAttribute("allow-hover"),this.menuTimeOut=e.hasAttribute("menu-time-out")?e.getAttribute("menu-time-out"):this.menuTimeOut)}else{const e=this.el.querySelector("ul > *:first-child");null!==e&&e.setAttribute("tabindex",0)}}isDesktop(){let e=!1;if(this.isSubmenu){let i=a(this.el,"bcgov-menu");if(null!==i&&i.getAttribute("breakpoint")){const t=parseInt(i.getAttribute("breakpoint"));e=window.innerWidth>=t}}else window.innerWidth>=this.breakpoint?(this.el.classList.contains("is-desktop")||this.el.classList.add("is-desktop"),void 0!==this.primary&&(this.bodyTag.classList.contains("bcgov-menu-primary-is-desktop")||this.bodyTag.classList.add("bcgov-menu-primary-is-desktop")),e=!0):(this.el.classList.remove("is-desktop"),void 0!==this.primary&&this.bodyTag.classList.remove("bcgov-menu-primary-is-desktop"));return e}onMouseEnter(e){if(this.isDesktop()&&this.allowHover){const i=e.target;i.focus(),this.showSubmenu(i,!0)}}onMouseLeave(e){if(this.isDesktop()&&this.allowHover){const i=e.target,t=this;clearTimeout(this.menuTimeOutState),this.menuTimeOutState=setTimeout(function(){t.showSubmenu(i,!1)},t.menuTimeOut),this.isSubmenu||[].forEach.call(this.el.querySelectorAll("ul > *"),function(e){e.setAttribute("tabindex",-1),e.blur()})}}onClick(e){const i=e.target,t=a(i,"bcgov-menu");null===i.closest(".bcgov-primary-menu-close")&&this.showSubmenu(t,!t.classList.contains("expanded")),"close-menu-mobile"===i.parentElement.getAttribute("id")&&t.classList.add("target-hidden")}onKeyDown(e){const i=e.srcElement;switch(e.keyCode){case o.enter:i.querySelector("a").click();case o.space:e.preventDefault(),e.stopPropagation(),this.showSubmenu(this.el,!0);break;case o.esc:e.preventDefault(),e.stopPropagation(),this.showSubmenu(this.el,!1);break;case o.right:e.preventDefault(),this.focusChange(i,"next");break;case o.left:e.preventDefault(),this.focusChange(i,"prev");break;case o.up:e.preventDefault(),this.focusChange(i,"up");break;case o.down:e.preventDefault(),this.focusChange(i,"down")}}focusChange(e,i="next"){let t;e===this.el.querySelector("ul")?(t=e.querySelector("li:first-child"),e=t=this.isDesktop()?t.nextElementSibling:t):"next"===i||"down"===i?t=e.nextElementSibling:"prev"!=i&&"up"!==i||(t=e.previousElementSibling);const s=null!==a(e,'ul[role="menu"]');(s&&("up"===i||"down"===i)||!s&&("prev"===i||"next"===i))&&(null==t||"LI"!==e.nodeName&&"BCGOV-MENU"!==e.nodeName||(e.setAttribute("tabindex","-1"),t.setAttribute("tabindex","0"),t.focus()))}render(){const e="align-"+this.alignment,s="bcgov-instructions-"+this.menuId;let n="expandable";if(this.isSubmenu)return void 0!==this.active&&this.active&&(n+=" active"),i(t,{role:"menuitem",class:n,"aria-label":this.name},i("div",null,i("a",{href:this.href,tabindex:"-1"},this.name),i("span",null),i("slot",{name:"submenu-link"})),i("ul",{role:"menu","aria-hidden":"true"},i("slot",null)));{const n={role:"menubar",tabindex:"0",class:e};return void 0!==this.primary&&(n["aria-labelledby"]=s),void 0!==this.sidebar&&(n.class+=" sidebar-menu"),i(t,null,i("ul",Object.assign({},n),void 0!==this.primary&&i("li",{role:"menuitem",class:"bcgov-primary-menu-close",tabindex:"-1","aria-hidden":"true","aria-labelId":"close-menu-mobile"},i("a",{href:"#","aria-label":"Close Mobile Menu",id:"close-menu-mobile"},i("span",null,"x"))),i("slot",null)),void 0!==this.primary&&i("div",{class:"sr-only","aria-hidden":"true",id:s},this.instructions))}}get el(){return s(this)}};export{l as bcgov_menu};