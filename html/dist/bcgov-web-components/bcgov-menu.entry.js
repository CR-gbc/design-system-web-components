import{r as i,h as t,H as e,g as s}from"./index-e8a35f72.js";import{m as n,a,k as o}from"./utils-9a052f8d.js";const l=class{constructor(t){i(this,t),this.alignment="left",this.menuId="menu",this.instructions="Use arrow keys to navigate between menuitems,\n  spacebar to expand submenus, escape key to close submenus, enter to activate menuitems.",this.breakpoint=0,this.hamburger=!0,this.active=!1,this.allowHover=!1,this.menuTimeOut=500,this.isSubmenu=!1,this.showSubmenu=(i,t)=>{if(!this.isSubmenu)return;t?i.classList.add("expanded"):i.classList.remove("expanded"),i.setAttribute("aria-expanded",t?"true":"false"),i.setAttribute("tabindex",t?"-1":"0");const e=i.querySelector("ul");null!==e&&(e.setAttribute("aria-hidden",t?"false":"true"),t)&&i.querySelector("ul > li:first-child").setAttribute("tabindex","0")}}componentWillLoad(){this.isSubmenu="UL"===this.el.parentElement.nodeName,[].forEach.call(this.el.querySelectorAll("a"),(function(i){n(i)}));const i=this;this.bodyTag=document.getElementsByTagName("BODY")[0],this.isSubmenu||(this.isDesktop(),window.addEventListener("resize",(function(){i.isDesktop()})))}componentDidRender(){if(this.isSubmenu){this.el.setAttribute("aria-haspopup",!0),this.el.setAttribute("aria-expanded",!1),this.el.setAttribute("tabindex",-1);const i=this.el.closest("bcgov-menu[primary]");null!==i&&(this.allowHover=this.allowHover||i.hasAttribute("allow-hover"),this.menuTimeOut=i.hasAttribute("menu-time-out")?i.getAttribute("menu-time-out"):this.menuTimeOut)}else{const i=this.el.querySelector("ul > *:first-child");null!==i&&i.setAttribute("tabindex",0)}}isDesktop(){let i=!1;if(this.isSubmenu){let t=a(this.el,"bcgov-menu");if(null!==t&&t.getAttribute("breakpoint")){const e=parseInt(t.getAttribute("breakpoint"));i=window.innerWidth>=e}}else window.innerWidth>=this.breakpoint?(this.el.classList.contains("is-desktop")||this.el.classList.add("is-desktop"),void 0!==this.primary&&(this.bodyTag.classList.contains("bcgov-menu-primary-is-desktop")||this.bodyTag.classList.add("bcgov-menu-primary-is-desktop")),i=!0):(this.el.classList.remove("is-desktop"),void 0!==this.primary&&this.bodyTag.classList.remove("bcgov-menu-primary-is-desktop"));return i}onMouseEnter(i){this.isDesktop()&&this.allowHover&&this.showSubmenu(i.target,!0)}onMouseLeave(i){if(this.isDesktop()&&this.allowHover){const t=i.target,e=this;clearTimeout(this.menuTimeOutState),this.menuTimeOutState=setTimeout((function(){e.showSubmenu(t,!1)}),e.menuTimeOut),this.isSubmenu||[].forEach.call(this.el.querySelectorAll("ul > *"),(function(i){i.setAttribute("tabindex",-1),i.blur()}))}}onClick(i){const t=i.target,e=a(t,"bcgov-menu");null===t.closest(".bcgov-primary-menu-close")&&this.showSubmenu(e,!e.classList.contains("expanded")),"close-menu-mobile"===t.parentElement.getAttribute("id")&&e.classList.add("target-hidden")}onKeyDown(i){const t=i.srcElement;switch(i.keyCode){case o.enter:t.querySelector("a").click();case o.space:i.preventDefault(),i.stopPropagation(),this.showSubmenu(this.el,!0),this.el.querySelector("ul > li:first-child").focus();break;case o.esc:i.preventDefault(),i.stopPropagation(),this.showSubmenu(this.el,!1),this.el.focus();break;case o.right:i.preventDefault(),this.focusChange(t,"next");break;case o.left:i.preventDefault(),this.focusChange(t,"prev");break;case o.up:i.preventDefault(),this.focusChange(t,"up");break;case o.down:i.preventDefault(),this.focusChange(t,"down")}}focusChange(i,t="next"){let e;i===this.el.querySelector("ul")?(e=i.querySelector("li:first-child"),e=this.isDesktop()?e.nextElementSibling:e,i=e):"next"===t||"down"===t?e=i.nextElementSibling:"prev"!=t&&"up"!==t||(e=i.previousElementSibling);const s=null!==a(i,'ul[role="menu"]');(s&&("up"===t||"down"===t)||!s&&("prev"===t||"next"===t))&&(null==e||"LI"!==i.nodeName&&"BCGOV-MENU"!==i.nodeName||(i.setAttribute("tabindex","-1"),e.setAttribute("tabindex","0"),e.focus()))}render(){const i="align-"+this.alignment,s="bcgov-instructions-"+this.menuId;let n="expandable";if(this.isSubmenu)return void 0!==this.active&&this.active&&(n+=" active"),t(e,{role:"menuitem",class:n,"aria-label":this.name},t("div",null,t("a",{href:this.href,tabindex:"-1"},this.name),t("span",null),t("slot",{name:"submenu-link"})),t("ul",{role:"menu","aria-hidden":"true"},t("slot",null)));{const n={role:"menubar",tabindex:"0",class:i};return void 0!==this.primary&&(n["aria-labelledby"]=s),void 0!==this.sidebar&&(n.class+=" sidebar-menu"),t(e,null,t("ul",Object.assign({},n),void 0!==this.primary&&t("li",{role:"menuitem",class:"bcgov-primary-menu-close",tabindex:"-1","aria-hidden":"true","aria-labelId":"close-menu-mobile"},t("a",{href:"#","aria-label":"Close Mobile Menu",id:"close-menu-mobile"},t("span",null,"x"))),t("slot",null)),void 0!==this.primary&&t("div",{class:"sr-only","aria-hidden":"true",id:s},this.instructions))}}get el(){return s(this)}};export{l as bcgov_menu}